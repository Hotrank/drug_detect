
Mount Shared Folder:
/usr/bin/vmhgfs-fuse .host:/VMWareSharedFolder /home/heming/Desktop/shared

Send file to AWS:
scp -i ~/.ssh/heming-IAM-keypair.pem -r /home/heming/Desktop/shared/drug_detect ubuntu@ec2-18-235-137-5.compute-1.amazonaws.com:/home/ubuntu/

send file from AWS EC2 instance to local
scp -i ~/.ssh/heming-IAM-keypair.pem ubuntu@18.235.137.5:/home/ubuntu/projects/drug_detect/src/test_k8server_throughput.py /home/heming/


run tensorflow serving docker image with my model folder mounted:
sudo docker run -p 8501:8501 --name serving_base \
--mount type=bind,source=/home/ubuntu/drug_detect/model/exported,target=/models/drug_detector \
-e MODEL_NAME=drug_detector -t tensorflow/serving

stop this container:
sudo docker stop serving_base

start new ssh agent:
eval "$(ssh-agent -s)"

install Docker:
follow instruction from this post: https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-16-04

install nvidia-docker following this post: https://github.com/NVIDIA/nvidia-docker#quick-start


create tensorflow serving image with my own model:
sudo docker run -d --name serving_base_1 tensorflow/serving:latest-gpu
sudo docker cp /home/ubuntu/drug_detect/model/exported serving_base_1:models/drug_detector
sudo docker commit --change "ENV MODEL_NAME drug_detector" serving_base_1 heming/drug-detector-gpu
sudo docker kill serving_base_1
To check if copy succeeded, go to the running container
sudo docker exec -it <container_name> /bin/bash



run the tensorflow serving image as a container:
sudo docker run -p 8501:8501 -t $USER/drug_detect_serving &
#-p 8501:8501 means: Publishing the container’s port 8501 (where TF Serving responds to REST API requests) to the host’s port 8501

To run it on a GPU server add the --runtime option:
sudo docker run --runtime=nvidia -p 8501:8501 -t heming/drug-detector-gpu &

install miniconda following this post:
https://gist.github.com/arose13/fcc1d2d5ad67503ba9842ea64f6bac35

set environment with tensorflow and python 3.5
conda create --name tf tensorflow python=3.5



install Docker:
follow instruction from this post: https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-16-04


To install zmq and pyzmq
sudo apt-get install libzmq3-dev
conda install -c anaconda pyzmq


install anaconda on ubuntu 16:
curl -O https://repo.continuum.io/archive/Anaconda3-5.0.1-Linux-x86_64.sh
bash Anaconda3-5.0.1-Linux-x86_64.sh

create tensorflow environment with python 3.5
conda create -n tf tensorflow python=3.5

get GPU info:
sudo lshw -C display

delete all stopped containers:
docker rm $(docker ps -a -q)
