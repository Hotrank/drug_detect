to spin up a kubernetes cluster on AWS:
create an IAM user and assign policy
aws configure: this will promt you to enter IAM credential and region
create an s3 bucket and enable versioning to store kubernetes state
export KOPS_CLUSTER_NAME=heming-gpu.k8s.local
export KOPS_STATE_STORE=s3://kops-state-heming

kops create cluster --node-count=2 --node-size=p2.xlarge --zones=us-east-1b --master-size=m4.large
# edit the configuration to set the OS system (AMI)
find the AMI ID for the operating system image on the AWS website
then use command: aws ec2 describe-images --image-id ami-0f9cf087c1f27d9b1 to find the image location
#then edit the image specification in the cluster setup
kops edit ig --name=heming-gpu.k8s.local nodes




kops update cluster --name ${KOPS_CLUSTER_NAME} --yes
kops validate cluster  (it might take a few minutes for the cluster to be ready)


To check cluster info:
kubectl cluster-info

To install a dashboard for kubernetes:
kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml

kubectl proxy
Then after getting the tokens set up I can see the dashboard on:
http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/
token: 4trddmRaYY2wRngW4QbJWx16e9TM0dWV

Kubernetes have pod, deployment, service. Usually don't need to create pod, just create a service and specify
the container, and the replicaset, it will automatically create the pods.
Then, create a service with type: LoadBalancer to expose the app.

to create a deployment, edit deployment.yml then run:
kubectl create -f deployment.yml
to update the deployent, edit the file and then run:
kubectl apply -f deployment.yml

to create a service, edit service.yml then run
kubectl create -f service.yml


To see pods/services/deployments:
kubectl get pods

To delete a service:
kubectl delete svc <YourServiceName>

To scale a deployment:
kubectl scale deployments/drug-detector-dep --replicas=3

To stop the cluster and restart, follow the last response in this post:
https://github.com/kubernetes/kops/issues/1132

first edit the nodes config, change the min and max sizes to 0:
kops edit ig nodes --name heming.k8s.local

then update the cluster:
kops update cluster --name heming.k8s.local --yes
kops rolling-update cluster --name heming.k8s.local
